<!DOCTYPE html>
<html>

	  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <!-- Mobile viewport optimized: h5bp.com/viewport -->
    <meta name="viewport" content="width=device-width">
    <link href='http://fonts.googleapis.com/css?family=Lato:300,700|Crete+Round' rel='stylesheet' type='text/css'>
    <link href="/css/style.css" rel="stylesheet">

    <title>Creating New Items in Zotero</title>
        
    <link rel="stylesheet" href="/css/pygments.css">

    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="/js/ui.js"></script>
    
    <script>
      $(document).ready(function(){
        $('.slide-trigger').collapsable();
      });
    </script>

  </head>




  <body>

    <header role="banner">
    <h1><a href="\">The Programming Historian</a></h1>

	        <div class="additional">
          <ul id="menu-main-menu" class="additional">
            <li class="menu-item"><a href="/about">About</a></li>
            <li class="menu-item"><a href="/lessons">Lessons</a></li>
            <li class="menu-item"><a href="/submissions">Submissions</a></li>
            <li class="menu-item"><a href="/team">Project Team</a></li>
          </ul>
        </div>
	</header>

	<div role="main">
		<article>
			<header>
				<h1>Creating New Items in Zotero</h1>
			</header>

			<div class="content">
	              <h2 id="using-python-to-create-a-new-zotero-item">Using Python to Create a New Zotero Item</h2>

<p>In the lesson on <a href="using-the-zotero-api">Using the Zotero API</a>,
you learned a little bit about how Zotero and its API; now you can access some of its
functions using Python scripts. In this lesson, you will create a new
item in a Zotero library and add some basic metadata such as title and
date.</p>

<h3 id="creating-a-new-zotero-item">Creating a new Zotero Item</h3>

<p>It will be helpful to remember that Zotero is fundamentally a bibliography manager, and that an <em>item</em> on Zotero contains only metadata;
it’s a bit like a library calling card. To upload file contents into
Zotero, you would create an <em>attachment</em> to that item. But for now you
will start by creating a new Zotero Item and assigning some information
to metadata fields.</p>

<p>Your first step is to import the python modules that you will need for
this program.</p>

<div class="highlight"><pre><code class="python"><span class="kn">import</span> <span class="nn">obo</span>
<span class="kn">from</span> <span class="nn">libZotero</span> <span class="kn">import</span> <span class="n">zotero</span>
<span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">import</span> <span class="nn">datetime</span>
</code></pre></div>

<p>Your next line of code will connect to your zotero group library using
the unique group id and API key.</p>

<div class="highlight"><pre><code class="python"><span class="c">#links to zotero group library</span>
<span class="n">zlib</span> <span class="o">=</span> <span class="n">zotero</span><span class="o">.</span><span class="n">Library</span><span class="p">(</span><span class="s">&#39;group&#39;</span><span class="p">,</span> <span class="s">&#39;155975&#39;</span><span class="p">,</span><span class="s">&#39;&lt;null&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;f4Bfk3OTYb7bukNwfcKXKNLG&#39;</span><span class="p">)</span>
</code></pre></div>

<p>Now that you have imported the required modules and connected to your
Zotero library, you can create a new item with metadata.
Start by using the following code to create a new item of the type
<em>document</em> and set the title to <em>Python Lesson Document.</em></p>

<div class="highlight"><pre><code class="python"><span class="c">#create a new item of type document</span>
<span class="n">newItem</span> <span class="o">=</span> <span class="n">zotero</span><span class="o">.</span><span class="n">getTemplateItem</span><span class="p">(</span><span class="s">&#39;document&#39;</span><span class="p">)</span>

<span class="c">#sets the title of the item to Python Lesson Document</span>
<span class="n">newItem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;title&#39;</span><span class="p">,</span> <span class="s">&#39;Python Lesson Document&#39;</span><span class="p">)</span>
</code></pre></div>

<p>Next you will add two more types of metadata to your item. First, you
will add an abstract note, which is basically a short description of the
item you have created. Then you will set the item’s creation date to the
current date.</p>

<div class="highlight"><pre><code class="python"><span class="c">#adds a new abstract note</span>
<span class="n">newItem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;abstractNote&#39;</span><span class="p">,</span> <span class="s">&#39;Created using a zotero python library and the write api&#39;</span><span class="p">)</span>

<span class="c">#sets date to current date</span>
<span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%Y-%m-</span><span class="si">%d</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">newItem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;date&#39;</span><span class="p">,</span> <span class="n">now</span><span class="p">)</span>
</code></pre></div>

<p>Now that you have set the important metadata for your item, you can make
a request to the API to create that item. This code has set the
<em>writeFailure</em> property to display an error message if the item is not
successfully created.</p>

<div class="highlight"><pre><code class="python"><span class="c"># make the request to the API to create the item</span>
<span class="c"># a Zotero Item object will be returned</span>
<span class="c"># if the creation went okay it will have a writeFailure property set to False</span>
<span class="n">createdItem</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">createItem</span><span class="p">(</span><span class="n">newItem</span><span class="p">)</span>
<span class="k">if</span> <span class="n">createdItem</span><span class="o">.</span><span class="n">writeFailure</span> <span class="o">!=</span> <span class="bp">False</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">createdItem</span><span class="o">.</span><span class="n">writeFailure</span><span class="p">[</span><span class="s">&#39;code&#39;</span><span class="p">])</span>
   <span class="k">print</span><span class="p">(</span><span class="n">createdItem</span><span class="o">.</span><span class="n">writeFailure</span><span class="p">[</span><span class="s">&#39;message&#39;</span><span class="p">])</span>
</code></pre></div>

<p>Your last step is to add a <em>tag</em> to your new item. The following code
will tag your item as <em>python lesson</em> and update the item with the new
tag. Just as in the last segment, this code contains a <em>writeFailure</em>
property that will print an error message if the item has not updated
correctly.</p>

<div class="highlight"><pre><code class="python"><span class="c">#adds a new tag to the new item</span>
<span class="n">tagname</span> <span class="o">=</span> <span class="s">&#39;python lesson&#39;</span>

<span class="c">#in the bracket (tagname, &#39;&amp;lt;tag type:0&amp;gt;&#39;)</span>
<span class="n">createdItem</span><span class="o">.</span><span class="n">addTag</span><span class="p">(</span><span class="n">tagname</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">)</span>

<span class="c">#updates the item with the new tag</span>
<span class="n">updatedItem</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">writeUpdatedItem</span><span class="p">(</span><span class="n">createdItem</span><span class="p">)</span>
<span class="k">if</span> <span class="n">updatedItem</span><span class="o">.</span><span class="n">writeFailure</span> <span class="o">!=</span> <span class="bp">False</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error updating item&quot;</span><span class="p">)</span>
   <span class="k">print</span><span class="p">(</span><span class="n">updatedItem</span><span class="o">.</span><span class="n">writeFailure</span><span class="p">[</span><span class="s">&#39;code&#39;</span><span class="p">])</span>
   <span class="k">print</span><span class="p">(</span><span class="n">updatedItem</span><span class="o">.</span><span class="n">writeFailure</span><span class="p">[</span><span class="s">&#39;message&#39;</span><span class="p">])</span>
</code></pre></div>

<p>At last, you have created a new item with a title and a tag name. This
last line of code will confirm the item you have just created.</p>

<div class="highlight"><pre><code class="python"><span class="k">print</span> <span class="s">&#39;Created new item &lt;</span><span class="si">%s</span><span class="s">&gt; with new tag &lt;</span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">createdItem</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">tagname</span><span class="p">)</span>
</code></pre></div>

<p>If all has gone according to plan, your output should look like this:</p>

<div class="highlight"><pre><code class="python"><span class="n">Created</span> <span class="n">new</span> <span class="n">item</span> <span class="o">&lt;</span><span class="n">Python</span> <span class="n">Lesson</span> <span class="n">Document</span><span class="o">&gt;</span> <span class="k">with</span> <span class="n">new</span> <span class="n">tag</span> <span class="o">&lt;</span><span class="n">python</span> <span class="n">lesson</span><span class="o">&gt;</span>
</code></pre></div>

<p>You can also check your Zotero library to find the document that you
made using Python. The title, abstract, and date should be filled out,
and the tag should appear also. By editing the program above, you can
create items with different types (such as books, journal articles, or
newspapers) and specify more precise titles, creation dates, and tags.</p>

	        </div>
        </article>
    </div>

    </div> <!-- end below-nav -->

<footer role="contentinfo">

          <div class="additional">
          <ul id="menu-main-menu" class="additional">
            <li class="menu-item"><a href="/about">About</a></li>
            <li class="menu-item"><a href="/lessons">Lessons</a></li>
            <li class="menu-item"><a href="/submissions">Submissions</a></li>
            <li class="menu-item"><a href="/team">Project Team</a></li>
          </ul>
        </div>
<!--
<p><em>The Programming Historian</em> is released under the <a href="http://creativecommons.org/licenses/by/2.0/" rel="license">CC-BY</a> license.</p>

  <p id="logos"><a href="http://niche-canada.org/" id="niche"><img src="/images/niche.jpg" title="NiCHE"></a> <a href="http://chnm.gmu.edu" id="rrchnm"><img src="/images/rrchnm.png"></a></p>
-->
</footer>

    </body>
</html>
